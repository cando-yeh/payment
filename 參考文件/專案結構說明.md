# å°ˆæ¡ˆçµæ§‹èªªæ˜ (çµ¦é›¶ç¶“é©—é–‹ç™¼è€…)

> é€™ä»½æ–‡ä»¶èªªæ˜å°ˆæ¡ˆä¸­æ¯å€‹æª”æ¡ˆå’Œè³‡æ–™å¤¾çš„ç”¨é€”ï¼Œå¹«åŠ©ä½ å¿«é€Ÿç†è§£ SvelteKit å°ˆæ¡ˆçµæ§‹ã€‚

---

## ğŸ“ æ ¹ç›®éŒ„çµæ§‹

```
å ±éŠ·_new/
â”œâ”€â”€ ğŸ“ src/                    â† ğŸ”´ ä½ çš„ç¨‹å¼ç¢¼éƒ½åœ¨é€™è£¡
â”œâ”€â”€ ğŸ“ static/                 â† éœæ…‹æª”æ¡ˆ (åœ–ç‰‡ã€favicon)
â”œâ”€â”€ ğŸ“ node_modules/           â† npm å¥—ä»¶ (ä¸ç”¨ç®¡)
â”œâ”€â”€ ğŸ“ .svelte-kit/            â† ç·¨è­¯å¿«å– (ä¸ç”¨ç®¡)
â”œâ”€â”€ ğŸ“ åƒè€ƒæ–‡ä»¶/                â† è¨­è¨ˆæ–‡ä»¶
â”‚
â”œâ”€â”€ ï¿½ tests/                  â† ğŸ§ª E2E æ¸¬è©¦è…³æœ¬
â”‚
â”œâ”€â”€ ï¿½ğŸ“„ package.json            â† â­ å°ˆæ¡ˆè¨­å®šæª”
â”œâ”€â”€ ğŸ“„ svelte.config.js        â† SvelteKit è¨­å®š
â”œâ”€â”€ ğŸ“„ vite.config.ts          â† Vite æ‰“åŒ…å·¥å…·è¨­å®š
â”œâ”€â”€ ğŸ“„ vitest.config.ts        â† ğŸ§ª å–®å…ƒæ¸¬è©¦è¨­å®š
â”œâ”€â”€ ğŸ“„ playwright.config.ts    â† ğŸ§ª E2E æ¸¬è©¦è¨­å®š
â”œâ”€â”€ ğŸ“„ tsconfig.json           â† TypeScript è¨­å®š
â”œâ”€â”€ ğŸ“„ components.json         â† shadcn-svelte è¨­å®š
â”‚
â”œâ”€â”€ ğŸ“„ .env.example            â† ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ ğŸ“„ .gitignore              â† Git å¿½ç•¥æ¸…å–®
â””â”€â”€ ğŸ“„ README.md               â† å°ˆæ¡ˆèªªæ˜
```

---

## ğŸ”´ src/ (é‡é»ï¼æ‰€æœ‰ç¨‹å¼ç¢¼éƒ½åœ¨é€™è£¡)

```
src/
â”œâ”€â”€ ğŸ“„ app.html                â† HTML æ¨¡æ¿ (é€šå¸¸ä¸éœ€æ”¹)
â”œâ”€â”€ ğŸ“„ app.css                 â† å…¨åŸŸ CSS æ¨£å¼
â”œâ”€â”€ ğŸ“„ app.d.ts                â† â­ TypeScript å‹åˆ¥å®šç¾© (å®šç¾©å…¨åŸŸè³‡æ–™æ ¼å¼)
â”œâ”€â”€ ğŸ“„ hooks.server.ts         â† â­ ä¼ºæœå™¨æ””æˆªå™¨ (æª¢æŸ¥ç™»å…¥ã€æ¬Šé™)
â”‚
â”œâ”€â”€ ğŸ“ routes/                 â† â­ é é¢å’Œè·¯ç”±
â”‚   â”œâ”€â”€ ğŸ“„ +page.svelte        â† é¦–é  (/)
â”‚   â”œâ”€â”€ ğŸ“„ +layout.svelte      â† å…±ç”¨ç‰ˆé¢ (æ‰€æœ‰é é¢éƒ½æœƒç”¨)
â”‚   â”œâ”€â”€ ğŸ“„ +layout.server.ts   â† â­ è¼‰å…¥ç‰ˆé¢è³‡æ–™ (ä¾‹å¦‚ï¼šæŠ“å–ä½¿ç”¨è€…è³‡è¨Š)
â”‚   â””â”€â”€ ğŸ“ auth/callback/      â† ğŸ”‘ OAuth å›å‚³è™•ç†
â”‚       â””â”€â”€ ğŸ“„ +server.ts      â† è™•ç†ç™»å…¥æˆåŠŸå¾Œçš„ä»£ç¢¼äº¤æ›
â”‚
â””â”€â”€ ğŸ“ lib/                    â† â­ å…±ç”¨ç¨‹å¼ç¢¼åº«
    â”œâ”€â”€ ğŸ“ components/ui/      â† shadcn UI å…ƒä»¶
    â”œâ”€â”€ ğŸ“ hooks/              â† è‡ªè¨‚é‚è¼¯ Hooks
    â”œâ”€â”€ ğŸ“ scripts/            â† ğŸ› ï¸ è‡ªå‹•åŒ–è…³æœ¬ (å¦‚ï¼šåˆå§‹åŒ–è³‡æ–™åº«)
    â”œâ”€â”€ ğŸ“ assets/             â† è³‡æºæª”æ¡ˆ
    â”œâ”€â”€ ğŸ“„ index.ts            â† lib åŒ¯å‡ºå…¥å£ (æœå‹™æ«ƒæª¯)
    â”œâ”€â”€ ğŸ“„ supabase.ts         â† â­ Supabase ç”¨æˆ¶ç«¯è¨­å®š
    â””â”€â”€ ğŸ“„ utils.ts            â† å·¥å…·å‡½æ•¸ (å¦‚æ ¼å¼åŒ–)
```

---

## ğŸ“„ é‡è¦æª”æ¡ˆè©³è§£

### 1. `package.json` â­
**ç”¨é€”**ï¼šå°ˆæ¡ˆçš„ã€Œèº«åˆ†è­‰ã€ï¼Œè¨˜éŒ„ï¼š
- å°ˆæ¡ˆåç¨±ã€ç‰ˆæœ¬
- ä½¿ç”¨çš„å¥—ä»¶ (dependencies)
- å¯åŸ·è¡Œçš„æŒ‡ä»¤ (scripts)

**å¸¸ç”¨æŒ‡ä»¤**ï¼š
```bash
npm run dev      # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run build    # æ‰“åŒ…æˆæ­£å¼ç‰ˆ
npm run preview  # é è¦½æ­£å¼ç‰ˆ
```

---

### 2. `src/routes/+page.svelte`
**ç”¨é€”**ï¼šé¦–é å…§å®¹

**è¦å‰‡**ï¼š
- `routes/` è³‡æ–™å¤¾çµæ§‹ = ç¶²å€çµæ§‹
- `+page.svelte` = é é¢å…§å®¹
- `+layout.svelte` = å…±ç”¨ç‰ˆé¢

**ç¯„ä¾‹**ï¼š
```
src/routes/
â”œâ”€â”€ +page.svelte              â†’ /
â”œâ”€â”€ claims/
â”‚   â”œâ”€â”€ +page.svelte          â†’ /claims
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ +page.svelte      â†’ /claims/123 (å‹•æ…‹è·¯ç”±)
```

---

### 3. `src/routes/+layout.svelte`
**ç”¨é€”**ï¼šæ‰€æœ‰é é¢å…±ç”¨çš„å¤–æ¡†ï¼ˆå¦‚å°è¦½åˆ—ã€é å°¾ï¼‰

**ç¯„ä¾‹**ï¼š
```svelte
<script>
  import "../app.css";
</script>

<nav>å°è¦½åˆ—</nav>

<slot />   <!-- é€™è£¡æœƒæ”¾æ¯ä¸€é çš„å…§å®¹ -->

<footer>é å°¾</footer>
```

---

### 4. `src/lib/` (ç”¨ `$lib` å¼•å…¥)
**ç”¨é€”**ï¼šå­˜æ”¾å¯é‡è¤‡ä½¿ç”¨çš„ç¨‹å¼ç¢¼

**å¼•å…¥æ–¹å¼**ï¼š
```svelte
<script>
  // âŒ ä¸è¦é€™æ¨£å¯«
  import Button from '../../../lib/components/ui/button';
  
  // âœ… ç”¨ $lib åˆ¥å
  import { Button } from '$lib/components/ui/button';
</script>
```

---

### 5. `src/app.css`
**ç”¨é€”**ï¼šå…¨åŸŸ CSSï¼ŒåŒ…å« Tailwind è¨­å®šå’Œ shadcn æ¨£å¼è®Šæ•¸

---

### 6. `.env` (åŠ `.env.example`)
**ç”¨é€”**ï¼šç’°å¢ƒè®Šæ•¸ï¼ˆå­˜æ”¾å¯†é‘°èˆ‡é€£ç·šè³‡è¨Šï¼‰

**ç›®å‰åŒ…å«**ï¼š
- `PUBLIC_SUPABASE_URL`: Supabase ç¶²å€
- `PUBLIC_SUPABASE_ANON_KEY`: å…¬é–‹é‡‘é‘°
- `SUPABASE_SERVICE_ROLE_KEY`: **æ©Ÿå¯†é‡‘é‘°** (ä¸å¯å¤–æµ)
- `PUBLIC_APP_ENV`: ç’°å¢ƒæ¨™è¨˜ (å¦‚ development)

**æ³¨æ„**ï¼š
- `.env` åŒ…å«çœŸå¯¦å¯†é‘°ï¼Œ**çµ•å°ä¸èƒ½ä¸Šå‚³ Git**ã€‚
- `.env.example` æ˜¯ä¹¾æ·¨çš„ç¯„æœ¬ï¼Œå¯ä»¥ä¸Šå‚³ã€‚

---

### 11. `src/hooks.server.ts` â­
**ç”¨é€”**ï¼šä¼ºæœå™¨ç«¯çš„ã€Œç®¡ç†å“¡ã€ã€‚
- æ¯ç•¶æœ‰é é¢è«‹æ±‚æ™‚éƒ½æœƒå…ˆç¶“éé€™è£¡ã€‚
- ç”¨ä¾†æª¢æŸ¥ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹ã€ä¿è­·å¾Œå°è·¯ç”±ã€‚

---

### 12. `src/lib/supabase.ts` â­
**ç”¨é€”**ï¼šè¨­å®š SvelteKit èˆ‡ Supabase çš„é€£ç·šå·¥å» ã€‚
- å»ºç«‹é€£ç·šç”¨çš„ Client ç‰©ä»¶ã€‚
- è™•ç† Cookie èˆ‡ Session (ç™»å…¥ç‹€æ…‹) çš„åŒæ­¥ã€‚

---

### 13. `src/lib/scripts/init-supabase.ts` ğŸ› ï¸
**ç”¨é€”**ï¼šç’°å¢ƒåˆå§‹åŒ–è…³æœ¬ã€‚
- è‡ªå‹•å»ºç«‹å°ˆæ¡ˆæ‰€éœ€çš„ Storage Buckets (å¦‚ï¼šreceipts)ã€‚
- ä½¿ç”¨ Service Role Key åŸ·è¡Œé«˜æ¬Šé™æ“ä½œã€‚

---

### 14. `src/routes/auth/callback/+server.ts` ğŸ”‘
**ç”¨é€”**ï¼šOAuth é©—è­‰å›å‚³è™•ç†å™¨ã€‚
- æ¥æ”¶ Google ç™»å…¥æˆåŠŸå¾Œå›å‚³çš„ä»£ç¢¼ (code)ã€‚
- å°‡ä»£ç¢¼äº¤æ›æˆæ­£å¼çš„ä½¿ç”¨è€… Session ä¸¦å°å›é¦–é ã€‚

---

### 7. `svelte.config.js`
**ç”¨é€”**ï¼šSvelteKit è¨­å®šæª”

**é€šå¸¸ä¸éœ€è¦æ”¹**ï¼Œé™¤éè¦åŠ å…¥æ–°åŠŸèƒ½

---

### 8. `vite.config.ts`
**ç”¨é€”**ï¼šæ‰“åŒ…å·¥å…·è¨­å®š

**é€šå¸¸ä¸éœ€è¦æ”¹**

---

### 9. `tsconfig.json`
**ç”¨é€”**ï¼šTypeScript ç·¨è­¯è¨­å®š

**é€šå¸¸ä¸éœ€è¦æ”¹**

---

### 10. `components.json`
**ç”¨é€”**ï¼šshadcn-svelte è¨­å®š

**è¨˜éŒ„**ï¼š
- UI å…ƒä»¶å­˜æ”¾ä½ç½®
- ä½¿ç”¨çš„è‰²ç³» (Slate)

- ä½¿ç”¨çš„è‰²ç³» (Slate)

---

### 15. `vitest.config.ts` & `playwright.config.ts` ğŸ§ª
**ç”¨é€”**ï¼šæ¸¬è©¦ç’°å¢ƒè¨­å®šæª”ã€‚
- `vitest.config.ts`: è¨­å®šå–®å…ƒæ¸¬è©¦ç’°å¢ƒï¼ˆå¿«é€Ÿã€é‚è¼¯é©—è­‰ï¼‰ã€‚
- `playwright.config.ts`: è¨­å®šç€è¦½å™¨è‡ªå‹•åŒ–æ¸¬è©¦ç’°å¢ƒï¼ˆçœŸå¯¦æ“ä½œã€æµç¨‹é©—è­‰ï¼‰ã€‚

---

## ğŸš« ä¸éœ€è¦ç®¡çš„è³‡æ–™å¤¾

| è³‡æ–™å¤¾ | èªªæ˜ |
|--------|------|
| `node_modules/` | npm å¥—ä»¶ï¼Œè‡ªå‹•ç”Ÿæˆ |
| `.svelte-kit/` | ç·¨è­¯å¿«å–ï¼Œè‡ªå‹•ç”Ÿæˆ |
| `.git/` | Git ç‰ˆæœ¬æ§åˆ¶è³‡æ–™ |

---

## ğŸ’¡ é–‹ç™¼æ™‚å¸¸ç”¨è·¯å¾‘

| ä½ æƒ³åšä»€éº¼ | å»å“ªè£¡ |
|------------|--------|
| æ–°å¢é é¢ | `src/routes/` |
| ä¿®æ”¹å…±ç”¨ç‰ˆé¢ | `src/routes/+layout.svelte` |
| æ–°å¢/ä¿®æ”¹ UI å…ƒä»¶ | `src/lib/components/` |
| æ–°å¢å·¥å…·å‡½æ•¸ | `src/lib/utils.ts` |
| ä¿®æ”¹å…¨åŸŸæ¨£å¼ | `src/app.css` |
| è¨­å®šç’°å¢ƒè®Šæ•¸ | `.env` |

---

## ğŸ¯ SvelteKit è·¯ç”±è¦å‰‡é€ŸæŸ¥

| æª”æ¡ˆåç¨± | ç”¨é€” |
|----------|------|
| `+page.svelte` | é é¢å…§å®¹ |
| `+page.ts` | é é¢è¼‰å…¥è³‡æ–™ (client) |
| `+page.server.ts` | é é¢è¼‰å…¥è³‡æ–™ (server only) |
| `+layout.svelte` | å…±ç”¨ç‰ˆé¢ |
| `+layout.ts` | ç‰ˆé¢è¼‰å…¥è³‡æ–™ |
| `+error.svelte` | éŒ¯èª¤é é¢ |
| `+server.ts` | API ç«¯é» |

---

> ğŸ“š å¦‚æœ‰ç–‘å•ï¼Œå¯ä»¥æŸ¥é–± [SvelteKit å®˜æ–¹æ–‡ä»¶](https://kit.svelte.dev/docs)
